<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monaco Editor テスト</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1e1e1e;
            color: white;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .editor-container {
            height: 500px;
            border: 1px solid #3c3c3c;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .controls {
            margin-bottom: 15px;
            text-align: center;
        }
        
        button {
            padding: 8px 15px;
            margin: 0 5px;
            background: #007acc;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        
        button:hover {
            background: #005a9e;
        }
        
        select {
            padding: 8px;
            margin: 0 5px;
            background: #3c3c3c;
            color: white;
            border: 1px solid #555;
            border-radius: 3px;
        }
        
        .status {
            margin-top: 15px;
            text-align: center;
            color: #4CAF50;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Monaco Editor テスト</h1>
        
        <div class="controls">
            <label for="language">言語:</label>
            <select id="language">
                <option value="javascript">JavaScript</option>
                <option value="python">Python</option>
                <option value="java">Java</option>
                <option value="cpp">C++</option>
                <option value="html">HTML</option>
                <option value="css">CSS</option>
                <option value="json">JSON</option>
                <option value="markdown">Markdown</option>
            </select>
            
            <button onclick="changeTheme('vs-dark')">ダークテーマ</button>
            <button onclick="changeTheme('vs-light')">ライトテーマ</button>
            <button onclick="changeTheme('hc-black')">ハイコントラスト</button>
            
            <button onclick="getValue()">値を取得</button>
            <button onclick="clearEditor()">クリア</button>
        </div>
        
        <div id="editor" class="editor-container"></div>
        
        <div id="status" class="status">Monaco Editor を読み込み中...</div>
    </div>

    <script>
        let editor;

        // Monaco Editor を初期化
        require.config({ 
            paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs' }
        });

        require(['vs/editor/editor.main'], function () {
            // エディターを作成
            editor = monaco.editor.create(document.getElementById('editor'), {
                value: `// Monaco Editor のテストです
console.log("Hello, Monaco Editor!");

function test() {
    const message = "エディターが正常に動作しています";
    console.log(message);
    return message;
}

test();`,
                language: 'javascript',
                theme: 'vs-dark',
                fontSize: 14,
                lineNumbers: 'on',
                minimap: { enabled: true },
                scrollBeyondLastLine: false,
                automaticLayout: true,
                wordWrap: 'on',
                folding: true,
                renderWhitespace: 'selection',
                cursorBlinking: 'blink'
            });

            // エディターが作成されたことを通知
            document.getElementById('status').textContent = 'Monaco Editor が正常に読み込まれました！クリックして編集できます。';

            // 言語変更のイベントリスナー
            document.getElementById('language').addEventListener('change', function() {
                const language = this.value;
                monaco.editor.setModelLanguage(editor.getModel(), language);
                
                // 言語に応じたサンプルコードを設定
                editor.setValue(getSampleCode(language));
            });

            // エディターにフォーカスを設定
            editor.focus();
        });

        function getSampleCode(language) {
            const samples = {
                'javascript': `// JavaScript サンプル
console.log("Hello, JavaScript!");

function greet(name) {
    return \`Hello, \${name}!\`;
}

const result = greet("World");
console.log(result);`,

                'python': `# Python サンプル
print("Hello, Python!")

def greet(name):
    return f"Hello, {name}!"

result = greet("World")
print(result)`,

                'java': `// Java サンプル
public class Hello {
    public static void main(String[] args) {
        System.out.println("Hello, Java!");
        
        String result = greet("World");
        System.out.println(result);
    }
    
    public static String greet(String name) {
        return "Hello, " + name + "!";
    }
}`,

                'cpp': `// C++ サンプル
#include <iostream>
#include <string>

using namespace std;

string greet(string name) {
    return "Hello, " + name + "!";
}

int main() {
    cout << "Hello, C++!" << endl;
    
    string result = greet("World");
    cout << result << endl;
    
    return 0;
}`,

                'html': `<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Hello HTML</title>
</head>
<body>
    <h1>Hello, HTML!</h1>
    <p>Monaco Editor でHTMLを編集中</p>
    
    <script>
        console.log("Hello from HTML!");
    </script>
</body>
</html>`,

                'css': `/* CSS サンプル */
body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    margin: 0;
    padding: 20px;
}

.container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

h1 {
    color: #333;
    text-align: center;
}`,

                'json': `{
  "name": "Monaco Editor テスト",
  "version": "1.0.0",
  "description": "Monaco Editor の動作テスト用JSON",
  "features": [
    "シンタックスハイライト",
    "自動補完",
    "エラー検出",
    "コード折りたたみ"
  ],
  "config": {
    "theme": "vs-dark",
    "fontSize": 14,
    "wordWrap": true
  }
}`,

                'markdown': `# Monaco Editor テスト

Monaco Editor の **Markdown** 表示テストです。

## 機能一覧

- [x] シンタックスハイライト
- [x] 自動補完
- [x] エラー検出
- [ ] プレビュー機能

## コードブロック

\`\`\`javascript
console.log("Hello from Markdown!");
\`\`\`

## リンク

[Monaco Editor 公式サイト](https://microsoft.github.io/monaco-editor/)

**太字** と *斜体* のテストです。`
            };

            return samples[language] || `// ${language} サンプルコード\nconsole.log("Hello, ${language}!");`;
        }

        function changeTheme(theme) {
            if (editor) {
                monaco.editor.setTheme(theme);
                document.getElementById('status').textContent = `テーマを ${theme} に変更しました`;
            }
        }

        function getValue() {
            if (editor) {
                const value = editor.getValue();
                alert(`現在の値:\n\n${value.substring(0, 200)}${value.length > 200 ? '...' : ''}`);
            }
        }

        function clearEditor() {
            if (editor) {
                editor.setValue('');
                document.getElementById('status').textContent = 'エディターをクリアしました';
            }
        }

        // ウィンドウリサイズ時にエディターのサイズを調整
        window.addEventListener('resize', function() {
            if (editor) {
                editor.layout();
            }
        });
    </script>
</body>
</html>
